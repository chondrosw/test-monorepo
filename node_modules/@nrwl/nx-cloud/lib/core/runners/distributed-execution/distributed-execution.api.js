const a6_0x2e87=['RUNNER_FAILURE_PERF_ENTRY','parseCommand','getBranch','map','configuration','next','mapRespToPerfEntry','recordMetric','target','/nx-cloud/executions/complete-run-group','NX_CLOUD_DISTRIBUTED_EXECUTION_STOP_AGENTS_ON_FAILURE','completeRunGroupWithError','NX_CLOUD_DISTRIBUTED_EXECUTION_AGENT_COUNT','axiosMultipleTries','post','value','/nx-cloud/executions/start','error','data','DistributedExecutionApi','../../../utilities/metric-logger','createStartRequest','join','@nrwl/workspace/src/utilities/output','../../../utilities/axios','maxParallel','message','createMetricRecorder','@nrwl/workspace/src/tasks-runner/utils','axiosException','/nx-cloud/executions/status','__awaiter','throw','hash','__esModule','defineProperty','status','parallel','dteStart','agentCount','response','overrides','project','apiAxiosInstance','done','completeRunGroup'];(function(_0x1a9f5c,_0x2e872e){const _0x5bb36e=function(_0x244545){while(--_0x244545){_0x1a9f5c['push'](_0x1a9f5c['shift']());}};_0x5bb36e(++_0x2e872e);}(a6_0x2e87,0xd3));const a6_0x5bb3=function(_0x1a9f5c,_0x2e872e){_0x1a9f5c=_0x1a9f5c-0x0;let _0x5bb36e=a6_0x2e87[_0x1a9f5c];return _0x5bb36e;};'use strict';var __awaiter=this&&this[a6_0x5bb3('0x4')]||function(_0x532cc6,_0x4bf445,_0x4e46d8,_0x5639d2){function _0x6d329a(_0x3fa89f){return _0x3fa89f instanceof _0x4e46d8?_0x3fa89f:new _0x4e46d8(function(_0x119d4b){_0x119d4b(_0x3fa89f);});}return new(_0x4e46d8||(_0x4e46d8=Promise))(function(_0x4773aa,_0x2e6556){function _0x4fd8e7(_0x4893e1){try{_0x46cdf3(_0x5639d2[a6_0x5bb3('0x18')](_0x4893e1));}catch(_0x4821f5){_0x2e6556(_0x4821f5);}}function _0x1d2fd0(_0x11f1cd){try{_0x46cdf3(_0x5639d2[a6_0x5bb3('0x5')](_0x11f1cd));}catch(_0x28d513){_0x2e6556(_0x28d513);}}function _0x46cdf3(_0xd6afa2){_0xd6afa2[a6_0x5bb3('0x11')]?_0x4773aa(_0xd6afa2[a6_0x5bb3('0x22')]):_0x6d329a(_0xd6afa2['value'])['then'](_0x4fd8e7,_0x1d2fd0);}_0x46cdf3((_0x5639d2=_0x5639d2['apply'](_0x532cc6,_0x4bf445||[]))[a6_0x5bb3('0x18')]());});};Object[a6_0x5bb3('0x8')](exports,a6_0x5bb3('0x7'),{'value':!![]});exports[a6_0x5bb3('0x28')]=exports[a6_0x5bb3('0x26')]=void 0x0;const output_1=require(a6_0x5bb3('0x2a'));const axios_1=require(a6_0x5bb3('0x2b'));const utils_1=require(a6_0x5bb3('0x1'));const environment_1=require('../../../utilities/environment');const metric_logger_1=require(a6_0x5bb3('0x27'));class DistributedExecutionApi{constructor(_0x4d9d9d){this['apiAxiosInstance']=(0x0,axios_1['createApiAxiosInstance'])(_0x4d9d9d);}['start'](_0x2ddd28){var _0xc05d82;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x26a797=(0x0,metric_logger_1[a6_0x5bb3('0x0')])(a6_0x5bb3('0xb'));let _0x43c2f1;try{_0x43c2f1=yield(0x0,axios_1[a6_0x5bb3('0x20')])(()=>this[a6_0x5bb3('0x10')][a6_0x5bb3('0x21')](a6_0x5bb3('0x23'),_0x2ddd28));_0x26a797[a6_0x5bb3('0x1a')]((0x0,metric_logger_1[a6_0x5bb3('0x19')])(_0x43c2f1));}catch(_0x211ac3){_0x26a797[a6_0x5bb3('0x1a')](((_0xc05d82=_0x211ac3===null||_0x211ac3===void 0x0?void 0x0:_0x211ac3[a6_0x5bb3('0x2')])===null||_0xc05d82===void 0x0?void 0x0:_0xc05d82['response'])?(0x0,metric_logger_1[a6_0x5bb3('0x19')])(_0x211ac3[a6_0x5bb3('0x2')][a6_0x5bb3('0xd')]):metric_logger_1[a6_0x5bb3('0x13')]);throw _0x211ac3;}if(!_0x43c2f1[a6_0x5bb3('0x25')]['enabled']){throw new Error('Workspace\x20is\x20disabled.\x20Cannot\x20perform\x20distributed\x20task\x20executions.');}if(_0x43c2f1[a6_0x5bb3('0x25')]['error']){throw new Error(_0x43c2f1[a6_0x5bb3('0x25')][a6_0x5bb3('0x24')]);}return _0x43c2f1[a6_0x5bb3('0x25')]['id'];});}[a6_0x5bb3('0x9')](_0x4472bb){var _0x8c8bd7;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x2d59eb=(0x0,metric_logger_1[a6_0x5bb3('0x0')])('dteStatus');try{const _0xa29ad3=yield(0x0,axios_1[a6_0x5bb3('0x20')])(()=>this[a6_0x5bb3('0x10')][a6_0x5bb3('0x21')](a6_0x5bb3('0x3'),{'id':_0x4472bb}));_0x2d59eb[a6_0x5bb3('0x1a')]((0x0,metric_logger_1[a6_0x5bb3('0x19')])(_0xa29ad3));return _0xa29ad3[a6_0x5bb3('0x25')];}catch(_0x3b0a46){_0x2d59eb[a6_0x5bb3('0x1a')](((_0x8c8bd7=_0x3b0a46===null||_0x3b0a46===void 0x0?void 0x0:_0x3b0a46[a6_0x5bb3('0x2')])===null||_0x8c8bd7===void 0x0?void 0x0:_0x8c8bd7[a6_0x5bb3('0xd')])?(0x0,metric_logger_1[a6_0x5bb3('0x19')])(_0x3b0a46[a6_0x5bb3('0x2')][a6_0x5bb3('0xd')]):metric_logger_1['RUNNER_FAILURE_PERF_ENTRY']);output_1['output']['error']({'title':_0x3b0a46[a6_0x5bb3('0x2d')]});process['exit'](0x1);}});}[a6_0x5bb3('0x1e')](_0x2f198e,_0x507586){var _0x217e35;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x1c40be=(0x0,metric_logger_1[a6_0x5bb3('0x0')])(a6_0x5bb3('0x12'));try{const _0x4b5930=yield(0x0,axios_1[a6_0x5bb3('0x20')])(()=>this[a6_0x5bb3('0x10')][a6_0x5bb3('0x21')](a6_0x5bb3('0x1c'),{'runGroup':_0x2f198e,'criticalErrorMessage':_0x507586}),0x3);_0x1c40be[a6_0x5bb3('0x1a')]((0x0,metric_logger_1['mapRespToPerfEntry'])(_0x4b5930));}catch(_0x44d8aa){_0x1c40be['recordMetric'](((_0x217e35=_0x44d8aa===null||_0x44d8aa===void 0x0?void 0x0:_0x44d8aa[a6_0x5bb3('0x2')])===null||_0x217e35===void 0x0?void 0x0:_0x217e35[a6_0x5bb3('0xd')])?(0x0,metric_logger_1[a6_0x5bb3('0x19')])(_0x44d8aa[a6_0x5bb3('0x2')]['response']):metric_logger_1[a6_0x5bb3('0x13')]);}});}}exports[a6_0x5bb3('0x26')]=DistributedExecutionApi;function createStartRequest(_0x44d3ff,_0x9d371b,_0x24b005){const _0x59eccd=_0x9d371b[a6_0x5bb3('0x16')](_0x4d68cc=>{return _0x4d68cc[a6_0x5bb3('0x16')](_0x401ca4=>{return{'taskId':_0x401ca4['id'],'hash':_0x401ca4[a6_0x5bb3('0x6')],'projectName':_0x401ca4[a6_0x5bb3('0x1b')][a6_0x5bb3('0xf')],'target':_0x401ca4[a6_0x5bb3('0x1b')]['target'],'configuration':_0x401ca4[a6_0x5bb3('0x1b')][a6_0x5bb3('0x17')]||null,'params':(0x0,utils_1['unparse'])(_0x401ca4[a6_0x5bb3('0xe')])[a6_0x5bb3('0x29')]('\x20')};});});const _0x3fb54f={'command':(0x0,environment_1[a6_0x5bb3('0x14')])(),'branch':(0x0,environment_1[a6_0x5bb3('0x15')])(),'runGroup':_0x44d3ff,'tasks':_0x59eccd,'maxParallel':calculateMaxParallel(_0x24b005)};if(environment_1[a6_0x5bb3('0x1f')]){_0x3fb54f[a6_0x5bb3('0xc')]=environment_1[a6_0x5bb3('0x1f')];}if(!environment_1[a6_0x5bb3('0x1d')]){_0x3fb54f['stopAgentsOnFailure']=![];}return _0x3fb54f;}exports[a6_0x5bb3('0x28')]=createStartRequest;function calculateMaxParallel(_0x529222){if(_0x529222[a6_0x5bb3('0xa')]==='false'||_0x529222[a6_0x5bb3('0xa')]===![]){return 0x1;}else if(_0x529222[a6_0x5bb3('0xa')]==='true'||_0x529222[a6_0x5bb3('0xa')]===!![]){return Number(_0x529222[a6_0x5bb3('0x2c')]||0x3);}else if(_0x529222[a6_0x5bb3('0xa')]===undefined){return _0x529222['maxParallel']?Number(_0x529222['maxParallel']):0x3;}else{return Number(_0x529222['parallel'])||0x3;}}