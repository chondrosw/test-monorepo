const a7_0x3b7b=['executionId:\x20','TaskGraphCreator','cacheDirectory','createTaskGraph','find','COMPLETED','error','output','../../file-storage/e2e-encryption','configuration','Starting\x20distributed\x20command\x20execution','createStartRequest','self','addDependencies','get','__awaiter','tasks','exit','nxCloudDistributedTasksRunner','scheduleTask','filter','createNoNewMessagesTimeout','status','start','then','completeRunGroupWithError','completedTasks','Waiter','VERBOSE_LOGGING','run','targetDependencies','message','Error:','dependencies','Waiting...','Unable\x20to\x20complete\x20a\x20run.','taskId','lifeCycle','throw','delete','finally','stdout','findTask','@nrwl/workspace/src/tasks-runner/cache','log','addVerticalSeparator','submitRunMetrics','printRunGroupError','hash','splitTasksIntoStages','commandStatus','Distributed\x20Execution\x20Terminated','Found\x20unknown\x20task:\x20','Processing\x20task\x20','Observable','../../file-storage/file-storage','overrides','projectGraph','indexOf','value','project','axiosException','executionStatus','map','Status\x20update','next','write','catch','../../error/print-run-group-error','done','strictlyOrderedTargets','Successfully\x20completed\x20running\x20the\x20command.','join','See\x20run\x20details\x20at\x20','unparse','assign','number\x20of\x20completed\x20tasks:\x20','retrieve','copyFilesFromCache','getRunGroup','__esModule','./distributed-execution.api','Main\x20job\x20terminated\x20with\x20an\x20error:\x20\x22','length','FileStorage','E2EEncryption','defaultTargetDependencies','startTask','url','addTaskToGraph','criticalErrorMessage','add','parse','push','addTaskDependencies','endTask','apply','keys','note','projects','defineProperty','roots','target','has','../../../utilities/waiter','Command\x20execution\x20failed.','Extracting\x20artifacts'];(function(_0xf1a768,_0x3b7bf4){const _0x362c7b=function(_0x3690e1){while(--_0x3690e1){_0xf1a768['push'](_0xf1a768['shift']());}};_0x362c7b(++_0x3b7bf4);}(a7_0x3b7b,0xa3));const a7_0x362c=function(_0xf1a768,_0x3b7bf4){_0xf1a768=_0xf1a768-0x0;let _0x362c7b=a7_0x3b7b[_0xf1a768];return _0x362c7b;};'use strict';var __awaiter=this&&this[a7_0x362c('0x42')]||function(_0x1c9a63,_0x3ba65e,_0x2be7a2,_0xf6be24){function _0x4a2be2(_0x15e8a7){return _0x15e8a7 instanceof _0x2be7a2?_0x15e8a7:new _0x2be7a2(function(_0x181689){_0x181689(_0x15e8a7);});}return new(_0x2be7a2||(_0x2be7a2=Promise))(function(_0x4f5ba7,_0xe365d0){function _0x43ee43(_0xd61b54){try{_0x3bb011(_0xf6be24[a7_0x362c('0x9')](_0xd61b54));}catch(_0x1fda6c){_0xe365d0(_0x1fda6c);}}function _0x1fc4e3(_0x12902e){try{_0x3bb011(_0xf6be24[a7_0x362c('0x59')](_0x12902e));}catch(_0x4027d5){_0xe365d0(_0x4027d5);}}function _0x3bb011(_0x4606e0){_0x4606e0[a7_0x362c('0xd')]?_0x4f5ba7(_0x4606e0['value']):_0x4a2be2(_0x4606e0[a7_0x362c('0x3')])['then'](_0x43ee43,_0x1fc4e3);}_0x3bb011((_0xf6be24=_0xf6be24[a7_0x362c('0x28')](_0x1c9a63,_0x3ba65e||[]))['next']());});};Object[a7_0x362c('0x2c')](exports,a7_0x362c('0x18'),{'value':!![]});exports[a7_0x362c('0x34')]=exports[a7_0x362c('0x45')]=void 0x0;const Observable_1=require('rxjs/internal/Observable');const cache_1=require(a7_0x362c('0x5e'));const output_1=require('@nrwl/workspace/src/utilities/output');const utils_1=require('@nrwl/workspace/src/tasks-runner/utils');const stripJsonComments=require('strip-json-comments');const fs_1=require('fs');const distributed_execution_api_1=require(a7_0x362c('0x19'));const file_storage_1=require(a7_0x362c('0x6a'));const e2e_encryption_1=require(a7_0x362c('0x3b'));const waiter_1=require(a7_0x362c('0x30'));const environment_1=require('../../../utilities/environment');const print_run_group_error_1=require(a7_0x362c('0xc'));const create_no_new_messages_timeout_1=require('../../../utilities/create-no-new-messages-timeout');const metric_logger_1=require('../../../utilities/metric-logger');class NoopLifeCycle{[a7_0x362c('0x46')](_0x2bb0fa){}[a7_0x362c('0x1f')](_0x301f12){}[a7_0x362c('0x27')](_0x9962b9,_0x1930a0){}}function runDistributedExecution(_0x5d8334,_0x4c44bd,_0x1ad205,_0x5237a1,_0x2821ac,_0x591f2e,_0x120a1b){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x34e924=JSON[a7_0x362c('0x24')](stripJsonComments((0x0,fs_1['readFileSync'])('nx.json')['toString']()));const _0xb011fd=new TaskOrderer(_0x1ad205[a7_0x362c('0x1')],getDefaultDependencyConfigs(_0x34e924,_0x4c44bd))[a7_0x362c('0x64')](_0x120a1b);const _0x2f7702=yield _0x5d8334[a7_0x362c('0x4a')]((0x0,distributed_execution_api_1[a7_0x362c('0x3e')])(_0x591f2e,_0xb011fd,_0x4c44bd));return yield processTasks(_0x5d8334,_0x5237a1,_0x2821ac,_0x4c44bd,_0x2f7702,_0x120a1b,_0x1ad205);});}function processTasks(_0x3f22cc,_0x5093d4,_0x42a5a4,_0x3c2b54,_0x2436e4,_0x4f2a17,_0x122c2){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x5e54c2={};const _0x4c825c=(0x0,create_no_new_messages_timeout_1[a7_0x362c('0x48')])();const _0x4d923a=new waiter_1[(a7_0x362c('0x4e'))]();while(!![]){if(environment_1['VERBOSE_LOGGING']){output_1[a7_0x362c('0x3a')][a7_0x362c('0x2a')]({'title':a7_0x362c('0x55')});}yield _0x4d923a['wait']();const _0x4ae1cf=yield _0x3f22cc[a7_0x362c('0x49')](_0x2436e4);if(environment_1[a7_0x362c('0x4f')]){output_1[a7_0x362c('0x3a')]['note']({'title':a7_0x362c('0x8'),'bodyLines':[a7_0x362c('0x33')+_0x2436e4,'executionStatus:\x20'+_0x4ae1cf['executionStatus'],a7_0x362c('0x14')+_0x4ae1cf['completedTasks'][a7_0x362c('0x1b')],'error:\x20'+_0x4ae1cf[a7_0x362c('0x22')]]});}if(_0x4ae1cf[a7_0x362c('0x22')]){output_1[a7_0x362c('0x3a')][a7_0x362c('0x39')]({'title':a7_0x362c('0x66'),'bodyLines':[a7_0x362c('0x53'),_0x4ae1cf[a7_0x362c('0x22')]]});process[a7_0x362c('0x44')](0x1);}_0x4c825c(_0x4ae1cf[a7_0x362c('0x4d')][a7_0x362c('0x1b')]);for(const _0x337c7a of _0x4ae1cf[a7_0x362c('0x4d')]){if(_0x5e54c2[_0x337c7a[a7_0x362c('0x57')]])continue;yield processTask(_0x5093d4,_0x42a5a4,_0x122c2,_0x3c2b54,_0x4f2a17,_0x337c7a);_0x4d923a['reset']();_0x5e54c2[_0x337c7a[a7_0x362c('0x57')]]=!![];}if(_0x4ae1cf[a7_0x362c('0x6')]===a7_0x362c('0x38')){return{'commandStatus':_0x4ae1cf[a7_0x362c('0x65')],'runUrl':_0x4ae1cf['runUrl']};}}});}function processTask(_0x34a335,_0x504cfa,_0x3b8237,_0x40e478,_0x22016c,_0x3ea54e){return __awaiter(this,void 0x0,void 0x0,function*(){if(environment_1[a7_0x362c('0x4f')]){output_1[a7_0x362c('0x3a')][a7_0x362c('0x2a')]({'title':a7_0x362c('0x68')+_0x3ea54e[a7_0x362c('0x57')]});}const _0x537023=_0x22016c[a7_0x362c('0x37')](_0x139e7b=>_0x3ea54e['taskId']===_0x139e7b['id']);if(!_0x537023){throw new Error(a7_0x362c('0x67')+_0x3ea54e[a7_0x362c('0x57')]);}if(environment_1[a7_0x362c('0x4f')]){output_1[a7_0x362c('0x3a')]['note']({'title':'Retrieving\x20artifacts\x20from\x20'+_0x3ea54e[a7_0x362c('0x20')]});}yield _0x34a335[a7_0x362c('0x15')](_0x3ea54e[a7_0x362c('0x63')],_0x3ea54e['url'],_0x40e478[a7_0x362c('0x35')]||'./node_modules/.cache/nx');const _0x2db7c7=yield _0x504cfa[a7_0x362c('0x41')](Object[a7_0x362c('0x13')](Object['assign']({},_0x537023),{'hash':_0x3ea54e['hash']}));const _0x4a0a31=(0x0,utils_1['getOutputs'])(_0x3b8237[a7_0x362c('0x1')]['nodes'],_0x537023);if(environment_1[a7_0x362c('0x4f')]){output_1[a7_0x362c('0x3a')]['note']({'title':a7_0x362c('0x32'),'bodyLines':_0x4a0a31});}yield _0x504cfa[a7_0x362c('0x16')](_0x3ea54e[a7_0x362c('0x63')],_0x2db7c7,_0x4a0a31);output_1[a7_0x362c('0x3a')]['logCommand'](getCommand(_0x537023));process[a7_0x362c('0x5c')][a7_0x362c('0xa')](_0x2db7c7['terminalOutput']);output_1['output'][a7_0x362c('0x60')]();});}function getCommand(_0x1ab9aa){const _0xb861a3=(0x0,utils_1[a7_0x362c('0x12')])(_0x1ab9aa[a7_0x362c('0x0')]||{});const _0x1f0e9a=_0x1ab9aa[a7_0x362c('0x2e')][a7_0x362c('0x3c')]?':'+_0x1ab9aa['target']['configuration']:'';return['nx',a7_0x362c('0x50'),_0x1ab9aa[a7_0x362c('0x2e')][a7_0x362c('0x4')]+':'+_0x1ab9aa['target'][a7_0x362c('0x2e')]+_0x1f0e9a,..._0xb861a3][a7_0x362c('0x10')]('\x20');}const nxCloudDistributedTasksRunner=(_0x1833cc,_0x9cc86e,_0x2688ae)=>{if(environment_1['VERBOSE_LOGGING']){output_1[a7_0x362c('0x3a')]['note']({'title':a7_0x362c('0x3d')});}_0x9cc86e[a7_0x362c('0x58')]=new NoopLifeCycle();const _0x41caca=(0x0,environment_1[a7_0x362c('0x17')])();if(!_0x41caca){(0x0,print_run_group_error_1[a7_0x362c('0x62')])();return process[a7_0x362c('0x44')](0x1);}const _0x532587=new e2e_encryption_1[(a7_0x362c('0x1d'))](environment_1['ENCRYPTION_KEY']||_0x9cc86e['encryptionKey']);const _0x59bb2a=new file_storage_1[(a7_0x362c('0x1c'))](_0x532587);const _0x53b487=new cache_1['Cache'](_0x9cc86e);const _0x40b9a9=new distributed_execution_api_1['DistributedExecutionApi'](_0x9cc86e);runDistributedExecution(_0x40b9a9,_0x9cc86e,_0x2688ae,_0x59bb2a,_0x53b487,_0x41caca,_0x1833cc)[a7_0x362c('0x4b')](_0x3d7784=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){if(_0x3d7784['commandStatus']===0x0){output_1[a7_0x362c('0x3a')]['success']({'title':a7_0x362c('0xf'),'bodyLines':[a7_0x362c('0x11')+_0x3d7784['runUrl']]});}else{output_1[a7_0x362c('0x3a')][a7_0x362c('0x39')]({'title':a7_0x362c('0x31'),'bodyLines':['See\x20run\x20details\x20at\x20'+_0x3d7784['runUrl']]});}yield(0x0,metric_logger_1[a7_0x362c('0x61')])(_0x9cc86e);process[a7_0x362c('0x44')](_0x3d7784[a7_0x362c('0x65')]);}))[a7_0x362c('0xb')](_0x4353dc=>{output_1[a7_0x362c('0x3a')][a7_0x362c('0x39')]({'title':a7_0x362c('0x56'),'bodyLines':[_0x4353dc[a7_0x362c('0x52')]]});if(_0x4353dc[a7_0x362c('0x5')]){console[a7_0x362c('0x5f')](_0x4353dc[a7_0x362c('0x5')]);}else{console['log'](_0x4353dc);}_0x40b9a9[a7_0x362c('0x4c')](_0x41caca,a7_0x362c('0x1a')+_0x4353dc['message']+'\x22')[a7_0x362c('0x5b')](()=>process[a7_0x362c('0x44')](0x1));});return new Observable_1[(a7_0x362c('0x69'))](()=>{});};exports[a7_0x362c('0x45')]=nxCloudDistributedTasksRunner;class TaskOrderer{constructor(_0x1eeace,_0x375ffc){this[a7_0x362c('0x1')]=_0x1eeace;this['defaultTargetDependencies']=_0x375ffc;}[a7_0x362c('0x64')](_0x46e216){if(_0x46e216[a7_0x362c('0x1b')]===0x0)return[];const _0x12d18a=[];const _0x4abb74=this[a7_0x362c('0x36')](_0x46e216);const _0x3a8124=new Set(_0x46e216[a7_0x362c('0x7')](_0x4b5ced=>_0x4b5ced['id']));let _0x41e5ff=0x0;while(_0x3a8124['size']>0x0){const _0xda791e=_0x12d18a[_0x41e5ff]=[];for(const _0x5bbf34 of _0x3a8124){let _0x3d072b=!![];for(const _0x36ec9b of _0x4abb74['dependencies'][_0x5bbf34]){if(_0x3a8124[a7_0x362c('0x2f')](_0x36ec9b)){_0x3d072b=![];break;}}if(!_0x3d072b){continue;}const _0x4ca5d0=_0x4abb74[a7_0x362c('0x43')][_0x5bbf34];_0xda791e['push'](_0x4ca5d0);}for(const _0x30265e of _0xda791e){_0x3a8124[a7_0x362c('0x5a')](_0x30265e['id']);}_0x41e5ff++;}return _0x12d18a;}['createTaskGraph'](_0x170c6d){const _0x1a0d22=new TaskGraphCreator(this[a7_0x362c('0x1')],this[a7_0x362c('0x1e')]);return _0x1a0d22[a7_0x362c('0x36')](_0x170c6d);}}class TaskGraphCreator{constructor(_0x512354,_0x595d8c){this[a7_0x362c('0x1')]=_0x512354;this[a7_0x362c('0x1e')]=_0x595d8c;}[a7_0x362c('0x36')](_0x4b27e8){const _0x4d5ca0={'roots':[],'tasks':{},'dependencies':{}};for(const _0x24e740 of _0x4b27e8){this['addTaskToGraph'](_0x24e740,_0x4d5ca0);const _0x52f451=(0x0,utils_1['getDependencyConfigs'])(_0x24e740['target'],this[a7_0x362c('0x1e')],this[a7_0x362c('0x1')]);if(!_0x52f451){continue;}this[a7_0x362c('0x26')](_0x24e740,_0x52f451,_0x4b27e8,_0x4d5ca0);}_0x4d5ca0[a7_0x362c('0x2d')]=Object[a7_0x362c('0x29')](_0x4d5ca0[a7_0x362c('0x54')])[a7_0x362c('0x47')](_0x20fee8=>_0x4d5ca0['dependencies'][_0x20fee8][a7_0x362c('0x1b')]===0x0);return _0x4d5ca0;}[a7_0x362c('0x26')](_0x4f6118,_0x1625ce,_0xc593e7,_0x37bcab){for(const _0x1d0b51 of _0x1625ce){if(_0x1d0b51['projects']===a7_0x362c('0x3f')){for(const _0x5566fe of _0xc593e7){if(_0x5566fe[a7_0x362c('0x2e')]['project']===_0x4f6118[a7_0x362c('0x2e')]['project']&&_0x5566fe[a7_0x362c('0x2e')][a7_0x362c('0x2e')]===_0x1d0b51['target']){_0x37bcab[a7_0x362c('0x54')][_0x4f6118['id']][a7_0x362c('0x25')](_0x5566fe['id']);}}}else if(_0x1d0b51[a7_0x362c('0x2b')]===a7_0x362c('0x54')){const _0x20fc84=new Set();this[a7_0x362c('0x40')](_0x4f6118[a7_0x362c('0x2e')][a7_0x362c('0x4')],_0x1d0b51[a7_0x362c('0x2e')],_0xc593e7,_0x37bcab,_0x4f6118['id'],_0x20fc84);}}}[a7_0x362c('0x40')](_0x300d0b,_0x72e061,_0x3af0c7,_0x24a7d5,_0x5a0099,_0x3294b5){_0x3294b5[a7_0x362c('0x23')](_0x300d0b);const _0x1e502b=this[a7_0x362c('0x1')][a7_0x362c('0x54')][_0x300d0b];if(_0x1e502b){const _0x536e58=_0x1e502b[a7_0x362c('0x7')](_0x2d81e4=>_0x2d81e4['target']);for(const _0x260df2 of _0x536e58){if(_0x3294b5[a7_0x362c('0x2f')](_0x260df2)){continue;}const _0x548651=this[a7_0x362c('0x5d')]({'project':_0x260df2,'target':_0x72e061},_0x3af0c7);if(_0x548651){if(_0x24a7d5[a7_0x362c('0x54')][_0x5a0099][a7_0x362c('0x2')](_0x548651['id'])===-0x1){_0x24a7d5[a7_0x362c('0x54')][_0x5a0099]['push'](_0x548651['id']);}}else{this[a7_0x362c('0x40')](_0x260df2,_0x72e061,_0x3af0c7,_0x24a7d5,_0x5a0099,_0x3294b5);}}}}[a7_0x362c('0x5d')]({project,target},_0x2d9b02){return _0x2d9b02[a7_0x362c('0x37')](_0x188a34=>_0x188a34[a7_0x362c('0x2e')]['project']===project&&_0x188a34[a7_0x362c('0x2e')]['target']===target);}[a7_0x362c('0x21')](_0x503d4c,_0x8b0f8a){_0x8b0f8a[a7_0x362c('0x43')][_0x503d4c['id']]=_0x503d4c;_0x8b0f8a[a7_0x362c('0x54')][_0x503d4c['id']]=[];}}exports['TaskGraphCreator']=TaskGraphCreator;function getDefaultDependencyConfigs(_0xe70aea,_0x59f0b8){var _0x58ae5f,_0x108c18;const _0x12e465=(_0x58ae5f=_0xe70aea[a7_0x362c('0x51')])!==null&&_0x58ae5f!==void 0x0?_0x58ae5f:{};const _0x507d42=_0x59f0b8?(_0x108c18=_0x59f0b8[a7_0x362c('0xe')])!==null&&_0x108c18!==void 0x0?_0x108c18:['build']:[];for(const _0x70d58c of _0x507d42){_0x12e465[_0x70d58c]=_0x12e465[_0x70d58c]||[];_0x12e465[_0x70d58c]['push']({'target':_0x70d58c,'projects':a7_0x362c('0x54')});}return _0x12e465;}