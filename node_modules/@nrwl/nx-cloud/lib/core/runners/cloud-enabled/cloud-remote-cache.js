const a2_0x33d5=['cacheError','indexOf','__esModule','note','CloudRemoteCache','hashUrls','map','then','statuses','VERBOSE_LOGGING','hash','response','__awaiter','messages','get','next','axiosException','.\x20Status\x20404.','@nrwl/workspace/src/utilities/output','api','throw','output','NX_CLOUD_DISTRIBUTED_EXECUTION_ID','requests','storage','filter','fileStorage','done','runContext','startRun','Nx\x20Cloud:\x20Cache\x20miss\x20','put','Nx\x20Cloud:\x20Skipping\x20storing\x20','resolve','storeRequests','extractErrorMessage','defineProperty','store','all','status','cache-miss'];(function(_0x45378b,_0x33d557){const _0x2fed15=function(_0x19b9f1){while(--_0x19b9f1){_0x45378b['push'](_0x45378b['shift']());}};_0x2fed15(++_0x33d557);}(a2_0x33d5,0x187));const a2_0x2fed=function(_0x45378b,_0x33d557){_0x45378b=_0x45378b-0x0;let _0x2fed15=a2_0x33d5[_0x45378b];return _0x2fed15;};'use strict';var __awaiter=this&&this[a2_0x2fed('0x1f')]||function(_0x37c989,_0x3b6677,_0x34a7d6,_0x2c79bc){function _0x5f3cc7(_0x30df4b){return _0x30df4b instanceof _0x34a7d6?_0x30df4b:new _0x34a7d6(function(_0x2232fb){_0x2232fb(_0x30df4b);});}return new(_0x34a7d6||(_0x34a7d6=Promise))(function(_0x42e140,_0x1b59a9){function _0x230cb3(_0x288e53){try{_0x2377f1(_0x2c79bc[a2_0x2fed('0x22')](_0x288e53));}catch(_0x15bdbf){_0x1b59a9(_0x15bdbf);}}function _0x57f7ba(_0x507308){try{_0x2377f1(_0x2c79bc[a2_0x2fed('0x27')](_0x507308));}catch(_0x1c3da6){_0x1b59a9(_0x1c3da6);}}function _0x2377f1(_0x2bb52b){_0x2bb52b[a2_0x2fed('0x5')]?_0x42e140(_0x2bb52b['value']):_0x5f3cc7(_0x2bb52b['value'])[a2_0x2fed('0x1a')](_0x230cb3,_0x57f7ba);}_0x2377f1((_0x2c79bc=_0x2c79bc['apply'](_0x37c989,_0x3b6677||[]))[a2_0x2fed('0x22')]());});};Object[a2_0x2fed('0xe')](exports,a2_0x2fed('0x15'),{'value':!![]});exports[a2_0x2fed('0x17')]=void 0x0;const output_1=require(a2_0x2fed('0x25'));const environment_1=require('../../../utilities/environment');class CloudRemoteCache{constructor(_0x2d97a2,_0x1e17a7,_0x328994,_0x26cacb){this[a2_0x2fed('0x20')]=_0x2d97a2;this[a2_0x2fed('0x26')]=_0x1e17a7;this[a2_0x2fed('0x6')]=_0x328994;this['fileStorage']=_0x26cacb;this[a2_0x2fed('0xc')]=[];}['retrieve'](_0x560f40,_0xd3d51d){var _0x248a93;return __awaiter(this,void 0x0,void 0x0,function*(){if(this['messages'][a2_0x2fed('0x13')])return![];const _0x18d7c8=yield this[a2_0x2fed('0x18')](_0x560f40);if(!_0x18d7c8||!_0x18d7c8[a2_0x2fed('0x21')]){if(environment_1[a2_0x2fed('0x1c')]){output_1[a2_0x2fed('0x28')][a2_0x2fed('0x16')]({'title':a2_0x2fed('0x8')+_0x560f40+'.'});}this[a2_0x2fed('0x6')]['statuses'][_0x560f40]=a2_0x2fed('0x12');return![];}try{yield this[a2_0x2fed('0x4')]['retrieve'](_0x560f40,_0x18d7c8[a2_0x2fed('0x21')],_0xd3d51d);this[a2_0x2fed('0x6')][a2_0x2fed('0x1b')][_0x560f40]='remote-cache-hit';return!![];}catch(_0x4f987a){const _0x5a57e8=(_0x248a93=_0x4f987a[a2_0x2fed('0x23')])!==null&&_0x248a93!==void 0x0?_0x248a93:_0x4f987a;if(_0x5a57e8[a2_0x2fed('0x1e')]&&_0x5a57e8['response'][a2_0x2fed('0x11')]===0x194){if(environment_1[a2_0x2fed('0x1c')]){output_1[a2_0x2fed('0x28')][a2_0x2fed('0x16')]({'title':a2_0x2fed('0x8')+_0x560f40+a2_0x2fed('0x24')});}}else{this[a2_0x2fed('0x20')][a2_0x2fed('0x13')]=this[a2_0x2fed('0x20')][a2_0x2fed('0xd')](_0x5a57e8,a2_0x2fed('0x2'));}this[a2_0x2fed('0x6')][a2_0x2fed('0x1b')][_0x560f40]='cache-miss';return![];}});}[a2_0x2fed('0xf')](_0x268d99,_0x3ae3ea){return __awaiter(this,void 0x0,void 0x0,function*(){if(this[a2_0x2fed('0x20')][a2_0x2fed('0x13')])return![];const _0x6679d8=Promise[a2_0x2fed('0xb')]()['then'](()=>__awaiter(this,void 0x0,void 0x0,function*(){var _0x25405d;const _0x22da55=yield this[a2_0x2fed('0x18')](_0x268d99);if(!_0x22da55)return![];if(!_0x22da55[a2_0x2fed('0x9')]){if(environment_1[a2_0x2fed('0x1c')]){output_1[a2_0x2fed('0x28')][a2_0x2fed('0x16')]({'title':a2_0x2fed('0xa')+_0x268d99+'.\x20Read\x20only\x20token\x20is\x20used.'});}return!![];}try{yield this[a2_0x2fed('0x4')][a2_0x2fed('0xf')](_0x268d99,_0x22da55[a2_0x2fed('0x9')],_0x3ae3ea);return!![];}catch(_0x2d70a2){const _0x38a0c3=(_0x25405d=_0x2d70a2['axiosException'])!==null&&_0x25405d!==void 0x0?_0x25405d:_0x2d70a2;this[a2_0x2fed('0x20')]['cacheError']=this[a2_0x2fed('0x20')]['extractErrorMessage'](_0x38a0c3,'storage');return![];}}));this['storeRequests']['push'](_0x6679d8);return _0x6679d8;});}[a2_0x2fed('0x18')](_0x8b73b6){return __awaiter(this,void 0x0,void 0x0,function*(){if(_0x8b73b6 in this[a2_0x2fed('0x6')][a2_0x2fed('0x1')]){return(yield this[a2_0x2fed('0x6')]['requests'][_0x8b73b6])[_0x8b73b6];}else{const _0x191782=this['runContext']['scheduledTasks'][a2_0x2fed('0x3')](_0x5b4545=>!this[a2_0x2fed('0x6')][a2_0x2fed('0x1')][_0x5b4545['hash']])[a2_0x2fed('0x19')](_0x338660=>_0x338660[a2_0x2fed('0x1d')]);if(_0x191782[a2_0x2fed('0x14')](_0x8b73b6)===-0x1){_0x191782['push'](_0x8b73b6);}const _0x5a5fdf=this[a2_0x2fed('0x26')][a2_0x2fed('0x7')](environment_1[a2_0x2fed('0x0')],_0x191782);_0x191782['forEach'](_0x3aa64f=>{this['runContext'][a2_0x2fed('0x1')][_0x3aa64f]=_0x5a5fdf;});return(yield _0x5a5fdf)[_0x8b73b6];}});}['waitForStoreRequestsToComplete'](){return Promise[a2_0x2fed('0x10')](this[a2_0x2fed('0xc')])['then'](_0x469f1d=>_0x469f1d['reduce']((_0x1cf711,_0x19842f)=>_0x1cf711&&_0x19842f,!![]));}}exports[a2_0x2fed('0x17')]=CloudRemoteCache;